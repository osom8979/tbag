FROM ubuntu:18.04
MAINTAINER zer0 <osom8979@gmail.com>

ENV DEBIAN_FRONTEND noninteractive

RUN apt-get -qq update
RUN apt-get install -y g++ cmake
RUN apt-get install -y software-properties-common git curl ccache doxygen

RUN add-apt-repository ppa:jonathonf/ffmpeg-4
RUN apt-get -qq update
RUN apt-get install -y ffmpeg libavcodec-dev libavformat-dev libswscale-dev libavdevice-dev

ENV WORKING_DIR /tbag/working
ENV BUILD_DIR   /tbag/build

RUN mkdir -p $WORKING_DIR
RUN mkdir -p $BUILD_DIR

# tbag update.
COPY . $WORKING_DIR
WORKDIR $BUILD_DIR

# tbag build.
RUN cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Release $WORKING_DIR
RUN make
RUN make install

# tbag test.
WORKDIR /
CMD /usr/local/bin/tpot

