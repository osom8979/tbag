# Travis CI Build.
# HOME path: /home/travis
# Git clone path: /home/travis/build/osom8979/tbag
# build directory: $TRAVIS_BUILD_DIR

language: cpp

cache:
  apt: true
  directories:
    - $HOME/tparty
    - $TRAVIS_BUILD_DIR/cmake_build

compiler: g++

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      #- george-edison55-cmake-3.x # Disallowing sources: george-edison55-cmake-3.x
      - george-edison55-precise-backports
    packages:
      - automake
      - build-essential
      - git
      - cmake
      - cmake-data
      - curl
      - unzip
      - g++-5

before_install:
  #- sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
  #- sudo add-apt-repository --yes ppa:george-edison55/precise-backports
  #- sudo apt-get -qq update
  #- sudo apt-get install -y git cmake cmake-data curl unzip g++-5
  - export TPARTY_HOME=$HOME/tparty
  - export LD_LIBRARY_PATH=$TPARTY_HOME/local/lib:$LD_LIBRARY_PATH
  - export CXX=g++-5

script:
  - if [[ ! -d cmake_build ]]; then mkdir cmake_build; fi
  - cd cmake_build
  - cmake -DRUN_TRAVIS=ON ..
  - make
  - ./tester --gtest_filter=*

after_success:
  - curl -o codecov.sh https://codecov.io/bash
  - chmod +x codecov.sh
  - ./codecov.sh -t 6ec0cfc8-a00f-43c8-aab0-2754b9fba046

notifications:
  email:
    on_success: always
    on_failure: always

