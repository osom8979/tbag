# Travis CI Build.
# HOME path: /home/travis
# Git clone path: /home/travis/build/osom8979/tbag
# build directory: $TRAVIS_BUILD_DIR

language: cpp

cache:
  apt: true
  directories:
    - $HOME/tparty
    - $TRAVIS_BUILD_DIR/cmake_build/external/local

compiler: g++

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      #- george-edison55-cmake-3.x # Disallowing sources: george-edison55-cmake-3.x
      - george-edison55-precise-backports
    packages:
      - automake
      - build-essential
      - git
      - cmake
      - cmake-data
      - curl
      - unzip
      - g++-4.9

before_install:
  #- sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
  #- sudo add-apt-repository --yes ppa:george-edison55/precise-backports
  #- sudo apt-get -qq update
  #- sudo apt-get install -y git cmake cmake-data curl unzip g++-4.9
  - export TPARTY_HOME=$HOME/tparty
  - export LD_LIBRARY_PATH=$TPARTY_HOME/local/lib:$LD_LIBRARY_PATH
  - export CXX=g++-4.9

install:
  - bash script/travis_install.sh

script:
  - echo "Current dir: $PWD"
  - echo "Travis build dir: $TRAVIS_BUILD_DIR"
  - mkdir cmake_build
  - cd cmake_build
  - cmake -DSKIP_FSPOLL_TESTER=ON -DSKIP_FINDPATH_TESTER=ON ..
  - make VERBOSE=0
  - ./tester

notifications:
  email:
    on_success: always
    on_failure: always

